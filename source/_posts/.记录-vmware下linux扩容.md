## 0. 背景

昨天在给虚拟机安装内核编译环境的时候出现了空间不足的问题。情况大体是这样子的，我的虚拟机大约有30G的空间，在编译内核之前剩余17个G左右，我把内核源码下载下来，好不容易花了半个小时候编译好，结果在安装了一半的时候直接报错，说我no more space left。一查，发现编译产生的各种文件（驱动模块，中间文件等等）占用了16个G。excuse me？ 什么时候变这么大了。**所以才对虚拟机进行了扩容，这里对整个扩容过程作一个记录。**
<!-- more -->
## 1.  vmware设置

打开vmware，进入要进行扩容的系统的设置界面，然后选择如下图：

![](https://ae01.alicdn.com/kf/He97275a69daa40998b90f86b6846554ea.jpg)

注意要进行扩容需要删除所有快照，并且关机。

选择你要扩充的大小，如这里扩充到80G。

![](https://ae01.alicdn.com/kf/Hafe43d2859b64b59aaeff5e1a74f2bd1c.jpg)

光是这样做是不够的，我们还需要进入系统中进行相关的设置。

## 2. Gparted分区设置

进入到系统后，我们需要通过以下代码来安装gparted：

```shell
sudo apt install gparted
```

现在，打开gparted，你将看到类似下图的界面：

![](https://ae01.alicdn.com/kf/H4140df2400b34371afb873bc8e1bf788J.jpg)

这里大体分为了3个部分，sda1是系统的主分区，我们的根目录就挂载到这里，中间的扩展分区，扩展分区下又分出了一个swap逻辑分区，最右边的则是我们通过扩容而多出来的未分配的区域了。

现在我们要做的就是将这些未分配的空间分到咱们的主分区sda1中。不过在此之前我们需要删除扩展分区，具体执行步骤如下:

1. 选中sda5，linux_swap分区，右键，将它swap_off掉
2. 删除sda5
3. 删除sda2

现在，应该只剩下一个主分区sda1，和一个unallocated的分区。选中sda1，右键resize，调整到你想要的大小，但是要剩余一点空间来做swap分区，个人建议剩余1G即可。最后在剩余的这1G空间里，再做如下操作：

1. 右键，new一个扩展分区（extend），空间默认为全部（即剩余的1G）
2. 选中刚才新建的扩展分区，new一个逻辑分区，类型选择linux_swap即可。

到这一步，你已经完成了vmware 下的linux扩容。

## 参考
- [VMware下对Ubuntu进行扩充磁盘大小](https://blog.csdn.net/Timsley/article/details/50742755)
